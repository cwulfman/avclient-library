# AV Client Library

The AV Client Library is part of the ABC App Test Harness, as specified in the [ABC App Test Harness Specification](https://docs.google.com/document/d/1MhLahmuhXRyN7MRSqfFrjUaS1xmQsViTZ2kJGbbDOuY/edit?usp=sharing).

## Prequisites

*   [NodeJS](https://nodejs.org/en/)

## Installation

*   Clone this repository wherever you like.
*   Run `npm install` to install dependencies.
*   Run `npm test` to test.

## Stub Functionality

Check out the `stub` branch of this repository.  The following behaviors/functionalities are
implemented in the stub version.

### AccessCodeRequest
Return network error if ID# is all zeros, otherwise success.

## AccessCodeConstruct
* Any string will do for the CVR, which is not used in the stub
* The access code of 00000 is invalid, but user may retry entering the code
* The access code of 00001 is valid but expired
* The access code of 00002 simulates network error;
* Any other access code is valid;
*Fingerprint is either of two values, depending on prior calls; whichever one was returned previously, use the other one

zyx098-wvu765-tsr432-1234 
or 
tsr432-wvu765-zyx098-4321

## Spoil
* “Remember” the access code from the previous construct call;
* Access code of 00003 simulates network error;
* Access code of 00004 simulates invalid fingerprint
* Otherwise return valid

## Send
* “Remember” the access code from construct;
* Access code of 00005 simulates network error;
* Access code of 00006 simulates invalid fingerprint or other data
* Otherwise return valid
* Any input strings will do, non are used in the stub



# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

*   [AccessCodeRequest](#accesscoderequest)
    *   [Parameters](#parameters)
*   [AccessCodeConstruct](#accesscodeconstruct)
    *   [Parameters](#parameters-1)
*   [Spoil](#spoil)
    *   [Parameters](#parameters-2)
*   [Send](#send)
    *   [Parameters](#parameters-3)

## AccessCodeRequest

Request that an access code be sent to the user
(outside of th app; e.g. email), based on Voter's
input data.

Stub functionality: return network error if ID# is all zeros,
otherwise success

### Parameters

*   `firstName` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** voter's first name field
*   `lastName` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** voter's last name field
*   `dob` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** voter's date of birth field
*   `idNo` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** either the ID number the voter used before
    (DLN, state ID, SSN) or, if no ID number was provided, then
    the voter record ID number returned by the previous lookup call.

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** status (success or network error)

## AccessCodeConstruct

If an input access code is valid, constructs crypto-ballot stuff
under the covers and returns a ballot fingerprint.

### Parameters

*   `CVR` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
*   `accessCode` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Status, Fingerprint

## Spoil

Purpose: input a ballot fingerprint to invalidate
(aka spoil)

### Parameters

*   `fingerPrint`  
*   `fingerprint` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** status (success/invalid/networkError)

## Send

Purpose: input a ballot fingerprint of a ballot to send, along with
a couple files

### Parameters

*   `fingerprint` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
*   `affidavitPDF` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
*   `ballotPDF` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** status
